(global["webpackChunkuniapp_cocokele"]=global["webpackChunkuniapp_cocokele"]||[]).push([["pages/demo/components/signature"],{1864:function(t,e,i){"use strict";var n;i.r(e),i.d(e,{default:function(){return w}});var s,h=function(){var t=this,e=t.$createElement;t._self._c},a=[],c=i(6480)["default"],o=i(1372)["default"],l={data:function(){return{ctx:null,width:300,height:400,isDrawing:!1,hasDrawn:!1,lastX:0,lastY:0}},mounted:function(){this.initCanvas()},methods:{initCanvas:function(){var t=c.getSystemInfoSync();this.width=t.windowWidth,this.height=t.windowHeight-100,this.ctx=c.createCanvasContext("signatureCanvas",this),this.clearCanvas(),this.ctx.setStrokeStyle("#000000"),this.ctx.setLineWidth(3),this.ctx.setLineCap("round"),this.ctx.setLineJoin("round")},clearCanvas:function(){this.isDrawing=!1,this.hasDrawn=!1,this.ctx.clearRect(0,0,this.width,this.height),this.ctx.setFillStyle("#ffffff"),this.ctx.fillRect(0,0,this.width,this.height),this.ctx.setTextBaseline("top"),this.ctx.setTextAlign("center"),this.ctx.setFontSize(20),this.ctx.setFillStyle("#616165"),this.ctx.fillText("请在灰色区域内完成签名",this.width/2,30),this.ctx.draw(!0)},catchtouchstart:function(t){t.stopPropagation(),t.preventDefault(),console.log("开始绘制签名");var e=t.changedTouches[0],i=e.x,n=e.y;this.hasDrawn||(this.ctx.clearRect(0,0,this.width,this.height),this.ctx.setFillStyle("#ffffff"),this.ctx.fillRect(0,0,this.width,this.height),this.ctx.draw(!0)),this.isDrawing=!0,this.lastX=i,this.lastY=n,this.ctx.beginPath(),this.ctx.moveTo(i,n)},catchtouchmove:function(t){"stop"!=this.drawState&&(this.drawState="ing",t.touches.length>1||(this.ctx.setStrokeStyle("#000000"),this.ctx.setLineWidth(3),this.ctx.setShadow(0,0,.5,"#000000"),this.ctx.setLineCap("round"),this.ctx.setLineJoin("round"),this.ctx.lineTo(t.changedTouches[0].clientX,t.changedTouches[0].clientY),this.ctx.stroke(),this.ctx.draw(!0),this.ctx.moveTo(t.changedTouches[0].clientX,t.changedTouches[0].clientY)))},catchtouchend:function(t){this.isDrawing&&(t.stopPropagation(),t.preventDefault(),this.isDrawing=!1,this.hasDrawn=!0,this.ctx.draw(!0),this.drawState="ready")},ocrVK:function(){var t=o.createVKSession({track:{OCR:{mode:2}}});t.on("updateAnchors",function(t){console.log("anchors.text","".concat(t.map(function(t){return t.text})))}),t.start(function(e){e||t.runOCR({frameBuffer:frameBuffer,width:width,height:height})})},canvasToImg:function(){var t=this;this.hasDrawn?(this.drawState="stop",setTimeout(function(){try{c.canvasToTempFilePath({canvasId:"signatureCanvas",x:0,y:0,width:t.width,height:t.height,destWidth:2*t.width,destHeight:2*t.height,fileType:"png",quality:1,success:function(e){console.log("确认签名",e.tempFilePath),t.$emit("signatureComplete",e.tempFilePath)},fail:function(t){console.log("canvas转换失败",t),c.showToast({title:"生成签名失败",icon:"none"})}},t)}catch(e){console.error("生成签名图片失败:",e)}},100)):c.showToast({title:"请先完成签名",icon:"none"})}}},r=l,u=i(5282),d=i.n(u),f=(d(),i(8535)),g=(0,f["default"])(r,h,a,!1,null,"63ee1999",null,!1,n,s),w=g.exports},5282:function(){}}]),(global["webpackChunkuniapp_cocokele"]=global["webpackChunkuniapp_cocokele"]||[]).push([["pages/demo/components/signature-create-component"],{},function(t){t("6480")["createComponent"](t(1864))}]);